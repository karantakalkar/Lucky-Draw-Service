<div fxLayout="column" fxLayoutGap="5%">

  <div class="container">
    <button mat-raised-button color="warn" (click)="back.emit()" style="width:20px">
      Back
    </button>
  </div>

  <div class="container" *ngIf="upcoming">
    <mat-card>
      <mat-card-content>
        <p id="demo">
          <b>Upcoming Event</b> <br><br>
          {{ upcoming.draw }} <br><br>
          Reward: {{ upcoming.name }} <br><br>
          {{ upcoming.redeem_date }} &nbsp; {{ upcoming.timing }} Hrs
        </p>
      </mat-card-content>
    </mat-card>
  </div>

  <div>
    <mat-card>
      <mat-card-content>
        <mat-card-title>Welcome {{ user.username | titlecase }} ! </mat-card-title>
        <br>
        <br>
          <div fxLayout="column">
            <mat-form-field>
              <mat-label>Tickets</mat-label>
                <input matInput type="number"  min="1" max="5" [formControl]="tickets">
            </mat-form-field>
          </div>
      </mat-card-content>
      <mat-card-actions fxLayoutAlign="center">
        <button type="submit" color="primary" mat-raised-button (click) ='order()'>Get Tickets</button>
      </mat-card-actions>
    </mat-card>
  </div>

  <div>
    <mat-card>
      <mat-card-content>
        <div fxLayout="column">
          <mat-form-field>
            <mat-label>Lucky Draw</mat-label>
            <mat-select [formControl]="luckydraw">
              <mat-option *ngFor="let draw of data.draws" [value]="draw">{{ draw.name }}</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field>
            <mat-label>Ticket</mat-label>
            <mat-select [formControl]="regticket">
              <mat-option *ngFor="let ticket of ownedTickets" [value]="ticket.id" [disabled]="ticket.is_used">{{ ticket.unique_code }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      <mat-card-actions fxLayoutAlign="center">
        <button type="submit" color="primary" mat-raised-button (click) ='register()' [disabled]="ownedTickets.length == 0">Participate</button>
      </mat-card-actions>
      <table id="tables" *ngIf="luckydraw.value">
        <thead>
           <tr>
              <th>Reward</th>
              <th>Redeem Date</th>
              <th>Won ?</th>
              <th *ngIf="user.is_staff">Action</th>
           </tr>
        </thead>
        <tbody>
           <tr *ngFor="let reward of luckydraw.value.rewards">
              <td>{{ reward.name }}</td>
              <td>{{ reward.redeem_date }}</td>
              <td>{{ reward.is_won ? "Yes" : "No" }}</td>
              <td *ngIf="user.is_staff">
                 <button type="button" (click)="announce(reward)">Announce Winner</button>
              </td>
           </tr>
        </tbody>
     </table>
      </mat-card-content>
    </mat-card>
  </div>

  <div>
    <mat-card>
      <mat-card-content>
        <div>
          <h1>Winners</h1>
          <table id="tables">
             <thead>
                <tr>
                   <th>Name</th>
                   <th>Reward</th>
                   <th>Lucky Draw</th>
                   <th>Win Date</th>
                </tr>
             </thead>
             <tbody>
                <tr *ngFor="let winner of winners">
                   <td>{{ winner.user }}</td>
                   <td>{{ winner.reward }}</td>
                   <td>{{ winner.lucky_draw}}</td>
                   <td>{{ winner.win_date }}</td>
                </tr>
             </tbody>
          </table>
       </div>
      </mat-card-content>
    </mat-card>
  </div>

</div>
